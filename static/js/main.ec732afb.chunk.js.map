{"version":3,"sources":["api/wallet-backend.js","app.js","index.js"],"names":["walletBackend","axios","create","baseURL","headers","disableSwalConfig","allowEscapeKey","backdrop","allowOutsideClick","App","useState","user","setUser","transList","setTranslist","currentPage","setCurrentPage","skipRecords","setSkipRecords","limitRecords","getUserDetails","a","get","id","data","localStorage","setItem","JSON","stringify","clear","getTransList","params","walletId","skip","limit","Array","length","addOrPayMoney","event","action","target","dataset","Swal","fire","title","html","showCancelButton","confirmButtonText","showLoaderOnConfirm","preConfirm","amount","document","getElementById","value","description","RegExp","test","showValidationMessage","successMsg","post","then","result","name","catch","error","errorMsg","response","prettyMsg","focus","pageChangeListener","variation","Math","ceil","useEffect","oldUser","parse","getItem","e","text","input","inputPlaceholder","balance","newUser","className","onClick","map","ele","index","Date","date","toLocaleString","type","abs","ReactDom","render","StrictMode"],"mappings":"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","file":"static/js/main.ec732afb.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst walletBackend = axios.create({\n    baseURL: 'https://wallet--backend.herokuapp.com/api',\n    headers: {\n        'Content-Type': 'application/json'\n    }\n});\n\nexport default walletBackend;","import Swal from 'sweetalert2'\nimport walletBackend from './api/wallet-backend';\nimport { useState, useEffect } from 'react';\nimport './app.css';\nconst disableSwalConfig = {\n    allowEscapeKey: false,\n    backdrop: true,\n    allowOutsideClick: false\n};\n\n\nconst App = () => {\n    const [user, setUser] = useState(null);\n    const [transList, setTranslist] = useState([]);\n    const [currentPage, setCurrentPage] = useState(1);\n    const [skipRecords, setSkipRecords] = useState(0);\n    const limitRecords = 10;\n    const getUserDetails = async (user) => {\n\n        try {\n            const { data: { data } } = await walletBackend.get(`/wallet/${user.id}`);\n            setUser(data);\n            localStorage.setItem('user', JSON.stringify(user));\n        } catch (error) {\n            localStorage.clear();\n        }\n    }\n    const getTransList = async (user, skipRecords) => {\n\n        try {\n            const { data: { data } } = await walletBackend.get(`/transactions`, {\n                params: {\n                    walletId: user.id,\n                    skip: skipRecords,\n                    limit: limitRecords\n                }\n            });\n            if (data instanceof Array && data.length) {\n                setTranslist(data);\n            }\n            return data;\n        } catch (error) {\n\n        }\n    }\n\n\n\n    const addOrPayMoney = (event) => {\n        const action = event.target.dataset.action;\n        const html = `\n            <form>\n             <label>Enter the amount(with max 4 decimal point). e.g. \"1000\" or \"10.5555\"</label><br/>\n             <input id=\"amount\" autocomplete=\"off\" class=\"swal2-input\" placeholder=\"Amount\" type=\"number\" />\n             <input id=\"description\" autocomplete=\"off\" class=\"swal2-input\" placeholder=\"Description\" type=\"text\" />\n            </form>\n        `;\n        Swal.fire({\n            title: `${action} Money`,\n            html: html,\n            showCancelButton: true,\n            confirmButtonText: action,\n            showLoaderOnConfirm: true,\n            ...disableSwalConfig,\n            preConfirm: () => {\n                let amount = +document.getElementById('amount').value;\n                let description = document.getElementById('description').value;\n                if (!amount || amount < 0.0001 || amount > 1000000 || !(new RegExp(/^\\d*(\\.\\d{1,4})?$/).test(amount))) return Swal.showValidationMessage(`Amount should be between 0.0001 to 1000000. Max. decimal points are 4`);\n                if (!description) Swal.showValidationMessage(`Description can't be empty`);\n                let successMsg = `You added INR ${amount} in your wallet!`;\n                if (action === 'Pay') {\n                    successMsg = `You paid INR ${amount} from your wallet!`;\n                    amount = -amount;\n                }\n                return walletBackend.post(`/transact/${user.id}`, {\n                    amount,\n                    description\n                }).then(result => {\n                    Swal.fire(`Good job! ${user.name}`, successMsg, \"success\");\n                    getUserDetails(user);\n                    getTransList(user, skipRecords);\n                }).catch(error => {\n                    let errorMsg = `Request failed: ${error}`;\n                    if (error && error.response && error.response.data) {\n                        errorMsg = error.response.data.prettyMsg;\n                    }\n                    Swal.showValidationMessage(errorMsg);\n                });\n            }\n        });\n        document.getElementById('amount').focus();\n    }\n    const pageChangeListener = async (action) => {\n        let variation;\n        if (action === 'prev') {\n            if (skipRecords === 0) {\n                return;\n            }\n            variation = skipRecords - limitRecords;\n        } else {\n            if (transList.length < limitRecords) {\n                return;\n            }\n            variation = skipRecords + limitRecords;\n        }\n        const data = await getTransList(user, variation);\n        if (data instanceof Array && data.length === 0) {\n            variation = (action === 'prev')\n                ? variation + limitRecords\n                : variation - limitRecords;\n        }\n        setSkipRecords(variation);\n        setCurrentPage(Math.ceil((variation + 1) / limitRecords));\n\n    }\n    useEffect(() => {\n        let oldUser;\n        try {\n            oldUser = JSON.parse(localStorage.getItem('user'));\n        } catch (e) { }\n\n        walletBackend.get(`/health`); //just to warm up the backend server\n        if (oldUser && oldUser.id) {\n            getUserDetails(oldUser);\n            getTransList(oldUser, skipRecords);\n        } else {\n            Swal.fire({\n                title: 'Setup new wallet',\n                text: 'Enter your name. e.g. \"Madhav Sharma\".',\n                input: 'text',\n                inputPlaceholder: \"Name\",\n                showCancelButton: false,\n                confirmButtonText: 'Create!',\n                showLoaderOnConfirm: true,\n                ...disableSwalConfig,\n                preConfirm: (name) => {\n                    if (!name || name.length < 4 || name.length > 25) return Swal.showValidationMessage(`Name length should be between 4 to 25 characters`);\n                    return walletBackend.post('/wallet/setup', {\n                        name,\n                        balance: 0\n                    }).then(result => {\n                        let newUser = result.data.data;\n                        setUser(newUser)\n                        localStorage.setItem('user', JSON.stringify(newUser));\n                        Swal.fire(`Good job! ${result.data.data.name}`, \"Your wallet is ready to use!\", \"success\");\n                    }).catch(error => {\n                        let errorMsg = `Request failed: ${error}`;\n                        if (error && error.response && error.response.data) {\n                            errorMsg = error.response.data.prettyMsg;\n                        }\n                        Swal.showValidationMessage(errorMsg);\n                    });\n                }\n            });\n        }\n\n    }, []);// eslint-disable-line react-hooks/exhaustive-deps\n    return (\n        <>\n            {(user && user.id) ? (\n                <>\n                    <div className=\"ui raised very padded text container segment\">\n                        <div className=\"card\">\n                            <div className=\"content\">\n                                <div className=\"header\">\n                                    Hello, {user.name} 👋\n                                </div>\n                                <br></br>\n                                <div className=\"description\">\n                                    Current Balance: INR <b>{user.balance}</b>\n                                </div>\n                            </div>\n                            <div className=\"extra content\">\n                                <div className=\"ui two buttons\">\n                                    <div className=\"ui basic green button\" data-action=\"Add\" onClick={(e) => addOrPayMoney(e)}>Add Money</div>\n                                    <div className=\"ui basic red button\" data-action=\"Pay\" onClick={(e) => addOrPayMoney(e)}>Pay</div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </>\n            ) : (\n                <div className=\"ui active inverted dimmer\">\n                    <div className=\"ui large text loader\">Loading</div>\n                </div>\n            )\n            }\n            {(transList && transList.length) ? (\n                <>\n                    <div className=\"ui raised very padded text container segment\">\n                        <h1>Transactions</h1>\n                        <table className=\"ui celled table fixed unstackable\">\n                            <thead>\n                                <tr><th>Date</th>\n                                    <th>Description</th>\n                                    <th>Amount</th>\n                                    <th>Balance</th>\n                                </tr></thead>\n                            <tbody>\n                                {transList.map((ele, index) => (<tr key={index}>\n                                    <td data-label=\"Date\">{new Date(ele.date).toLocaleString()}</td>\n                                    <td data-label=\"Description\">{ele.description}</td>\n                                    <td className={ele.type === 'CREDIT' ? 'positive' : 'negative'} data-label=\"Amount\">{Math.abs(ele.amount)} ({ele.type === 'CREDIT' ? 'Cr' : 'Dr'})</td>\n                                    <td data-label=\"Balance\">{ele.balance}</td>\n                                </tr>))}\n                            </tbody>\n                        </table>\n                        <div className=\"ui buttons three\" >\n                            <button className={`ui button ${(skipRecords === 0) ? 'disabled' : 'active'}`} onClick={() => pageChangeListener('prev')}>\n                                <i className=\"left arrow icon\"></i>Previous\n                            </button>\n                            <div className=\"or\" data-Text={currentPage}></div>\n                            <button className={`ui button ${(limitRecords > transList.length) ? 'disabled' : 'active'}`} onClick={() => pageChangeListener('next')}>\n                                Next<i className=\"right arrow icon\"></i>\n                            </button>\n                        </div>\n                    </div>\n                </>\n            ) : null}\n        </>\n    );\n}\n\nexport default App;","import React from 'react';\nimport ReactDom from 'react-dom';\nimport App from './app';\n\nReactDom.render(\n    <React.StrictMode><App /></React.StrictMode>,\n    document.getElementById('root')\n);"],"sourceRoot":""}