(this["webpackJsonpwallet-frontend"]=this["webpackJsonpwallet-frontend"]||[]).push([[0],{55:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var n=a(3),c=a.n(n),s=a(20),r=a.n(s),i=a(5),o=a(4),l=a.n(o),d=a(8),u=a(9),h=a(2),b=a.n(h),j=a(21),p=a.n(j).a.create({baseURL:"https://wallet--backend.herokuapp.com/api",headers:{"Content-Type":"application/json"}}),m=(a(55),a(0)),x={allowEscapeKey:!1,backdrop:!0,allowOutsideClick:!1},O=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)([]),r=Object(u.a)(s,2),o=r[0],h=r[1],j=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.get("/wallet/".concat(t.id));case 3:a=e.sent,n=a.data.data,c(n),localStorage.setItem("user",JSON.stringify(t)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),localStorage.clear();case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.get("/transactions",{params:{walletId:t.id,skip:0,limit:50}});case 3:a=e.sent,n=a.data.data,h(n),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),f=function(e){b.a.fire(Object(i.a)(Object(i.a)({title:"".concat(e," Money"),html:'\n            <form>\n             <label>Enter the amount(with max 4 decimal point). e.g. "1000" or "10.5555"</label><br/>\n             <input id="amount" class="swal2-input" placeholder="Amount" type="number" />\n             <input id="description" class="swal2-input" placeholder="Description" type="text" />\n            </form>\n        ',showCancelButton:!0,confirmButtonText:e,showLoaderOnConfirm:!0},x),{},{preConfirm:function(){var t=+document.getElementById("amount").value,n=document.getElementById("description").value;if(!t||t<1e-4||t>1e6||!new RegExp(/^\d*(\.\d{1,4})?$/).test(t))return b.a.showValidationMessage("Amount should be between 0.0001 to 1000000. Max. decimal points are 4");n||b.a.showValidationMessage("Description can't be empty");var c="You added INR ".concat(t," in your wallet!");return"Pay"===e&&(c="You paid INR ".concat(t," from your wallet!"),t=-t),p.post("/transact/".concat(a.id),{amount:t,description:n}).then((function(e){b.a.fire("Good job! ".concat(a.name),c,"success"),j(a),O(a)})).catch((function(e){var t="Request failed: ".concat(e);e&&e.response&&e.response.data&&(t=e.response.data.prettyMsg),b.a.showValidationMessage(t)}))}})),document.getElementById("amount").focus()};return Object(n.useEffect)((function(){var e;try{e=JSON.parse(localStorage.getItem("user"))}catch(t){}p.get("/health"),e&&e.id?(j(e),O(e)):b.a.fire(Object(i.a)(Object(i.a)({title:"Setup new wallet",text:'Enter your name. e.g. "Madhav Sharma".',input:"text",inputPlaceholder:"Name",showCancelButton:!1,confirmButtonText:"Create!",showLoaderOnConfirm:!0},x),{},{preConfirm:function(e){return!e||e.length<4||e.length>25?b.a.showValidationMessage("Name length should be between 4 to 25 characters"):p.post("/wallet/setup",{name:e,balance:0}).then((function(e){var t=e.data.data;c(t),localStorage.setItem("user",JSON.stringify(t)),b.a.fire("Good job! ".concat(e.data.data.name),"Your wallet is ready to use!","success")})).catch((function(e){var t="Request failed: ".concat(e);e&&e.response&&e.response.data&&(t=e.response.data.prettyMsg),b.a.showValidationMessage(t)}))}}))}),[]),Object(m.jsxs)(m.Fragment,{children:[a&&a.id?Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("div",{className:"ui raised very padded text container segment",children:Object(m.jsxs)("div",{className:"card",children:[Object(m.jsxs)("div",{className:"content",children:[Object(m.jsxs)("div",{className:"header",children:["Hello, ",a.name," \ud83d\udc4b"]}),Object(m.jsx)("br",{}),Object(m.jsxs)("div",{className:"description",children:["Current Balance: INR ",Object(m.jsx)("b",{children:a.balance})]})]}),Object(m.jsx)("div",{className:"extra content",children:Object(m.jsxs)("div",{className:"ui two buttons",children:[Object(m.jsx)("div",{className:"ui basic green button",onClick:function(){return f("Add")},children:"Add Money"}),Object(m.jsx)("div",{className:"ui basic red button",onClick:function(){return f("Pay")},children:"Pay"})]})})]})})}):Object(m.jsx)("div",{className:"ui active inverted dimmer",children:Object(m.jsx)("div",{className:"ui large text loader",children:"Loading"})}),o&&o.length?Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"ui raised very padded text container segment",children:[Object(m.jsx)("h1",{children:"Transactions"}),Object(m.jsxs)("table",{className:"ui celled table fixed unstackable",children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Date"}),Object(m.jsx)("th",{children:"Description"}),Object(m.jsx)("th",{children:"Amount"}),Object(m.jsx)("th",{children:"Balance"})]})}),Object(m.jsx)("tbody",{children:o.map((function(e,t){return Object(m.jsxs)("tr",{children:[Object(m.jsx)("td",{"data-label":"Date",children:new Date(e.date).toLocaleString()}),Object(m.jsx)("td",{"data-label":"Description",children:e.description}),Object(m.jsxs)("td",{className:"CREDIT"===e.type?"negative":"positive","data-label":"Amount",children:[Math.abs(e.amount)," (","CREDIT"===e.type?"Cr":"Dr",")"]}),Object(m.jsx)("td",{"data-label":"Balance",children:e.balance})]},t)}))})]})]})}):null]})};r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(O,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.33a48b07.chunk.js.map